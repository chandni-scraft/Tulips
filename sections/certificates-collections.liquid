{% schema %}
{
  "name": "Certificates Tabs Section",
  "tag": "section",
  "settings": [],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        {
          "type": "collection",
          "id": "selected_collection",
          "label": "Select a Collection"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Certificates Tabs Section"
    }
  ]
}
{% endschema %}

<div class="tabs-container">
  <ul class="tabs-nav">
    {% for block in section.blocks %}
      <li class="tab-nav-item" data-tab="tab-{{ block.id }}">
        {{ block.settings.selected_collection.title }}
      </li>
    {% endfor %}
  </ul>

  <div class="tabs-content">
    {% for block in section.blocks %}
      {% assign selected_collection = collections[block.settings.selected_collection.handle] %}
      <div id="tab-{{ block.id }}" class="tab-content">
        {% if selected_collection.metafields.custom.certificates %}
          <div class="certificates-gallery">
            {% for image in selected_collection.metafields.custom.certificates.value %}
              <div class="certificate-item">
                <img src="{{ image | img_url: 'master' }}" alt="Certificate Image">
              </div>
            {% endfor %}
          </div>
        {% else %}
          <p>No certificates found for this collection.</p>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

<!-- Image Modal -->
<div id="image-modal" class="image-modal">
  <span class="modal-close">&times;</span>
  <img class="modal-content" id="modal-img">
</div>

<style>
            .tabs-container {
              margin-top: 20px;
              text-align: center;
            }

            .tabs-nav {
              list-style-type: none;
              padding: 0;
              display: flex;
              justify-content: center;
            }

            .tab-nav-item {
              padding: 12px 14px;
              background-color: transparent;
              color: black;
              border: 2px solid white;
              border-radius: 50px;
              font-size: 18px;
              cursor: pointer;
              transition: all 0.3s ease;
            }

            .tab-nav-item.active {
              background: #ff6631;
              color: white;
            }

            .tab-content {
              display: none;
              text-align: center;
            }

            .certificates-gallery {
              display: flex;
              flex-wrap: wrap;
              justify-content: center;
              gap: 20px;
              margin: auto;
              max-width: 1200px;
            }

           .certificate-item {
    flex: 0 1 calc(33.33% - 20px); /* Show 3 per row with spacing */
    display: flex;
    justify-content: center;
    align-items: center;
  }

            .certificate-item img {
        width: 100%;              /* Fill container */
        height: auto;             /* Maintain aspect ratio */
        max-width: 600px;         /* Increase this as needed */
        max-height: 500px;        /* Or auto, depending on layout */
        object-fit: contain;      /* Keeps image fully visible */

        cursor: pointer;
        transition: transform 0.3s ease;
        image-rendering: auto;
      }


            @media (max-width: 768px) {
              .certificate-item {
                flex: auto;
              }

              .tab-nav-item {
                padding: 6px 9px;
                font-size: 12px;
              }
            }

            /* Modal Styles */
            .image-modal {
              display: none;
              position: fixed;
              z-index: 9999;
              left: 0;
              top: 0;
              width: 100%;
              height: 100%;
              background-color: rgba(0, 0, 0, 0.5);
              align-items: center;
              justify-content: center;
              animation: fadeIn 0.3s ease-in-out;
            }

            .image-modal.active {
              display: flex;
            }

           .modal-content {
      width: 100%;
      height: auto;
      max-width: 1000px;    /* Increase this as needed */
      max-height: 90vh;
      object-fit: contain;
      image-rendering: auto;
             padding:20px;
    }


            .modal-close {
              position: absolute;
              top: 20px;
              right: 30px;
              font-size: 40px;
              color: white;
              font-weight: bold;
              cursor: pointer;
              z-index: 10001;
            }

            @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
            }
</style>

<script>
  // Tab switching
  document.querySelectorAll('.tab-nav-item').forEach(item => {
    item.addEventListener('click', function () {
      const tabId = item.getAttribute('data-tab');
      document.querySelectorAll('.tab-content').forEach(tab => tab.style.display = 'none');
      document.getElementById(tabId).style.display = 'block';
      document.querySelectorAll('.tab-nav-item').forEach(tab => tab.classList.remove('active'));
      item.classList.add('active');
    });
  });

  // Show the first tab by default
  document.querySelector('.tab-nav-item')?.click();

  // Modal image viewer
  const modal = document.getElementById('image-modal');
  const modalImg = document.getElementById('modal-img');
  const closeBtn = document.querySelector('.modal-close');

  document.addEventListener('click', function (e) {
    if (e.target.matches('.certificate-item img')) {
      modal.classList.add('active');
      modalImg.src = e.target.src;
    }

    if (e.target === closeBtn || e.target === modal) {
      modal.classList.remove('active');
    }
  });
</script>
